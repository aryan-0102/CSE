bool isLL1(map<char, vector<string>> &prod,
           map<char, set<char>> &FIRST,
           map<char, set<char>> &FOLLOW) 
{
    for (auto &p : prod) {
        char A = p.first;
        auto &rhsList = p.second;

        for (int i = 0; i < rhsList.size(); i++) {
            for (int j = i + 1; j < rhsList.size(); j++) {

                string α = rhsList[i];
                string β = rhsList[j];

                set<char> FIRSTα = FIRST[α[0]];
                set<char> FIRSTβ = FIRST[β[0]];

                // Condition 1: FIRST/FIRST conflict
                for (char x : FIRSTα)
                    if (x != 'e' && FIRSTβ.count(x))
                        return false;

                // εCases
                bool αNullable = FIRSTα.count('e');
                bool βNullable = FIRSTβ.count('e');

                // Condition 2: FIRST/FOLLOW conflicts
                if (αNullable)
                    for (char x : FIRSTβ)
                        if (FOLLOW[A].count(x)) return false;

                if (βNullable)
                    for (char x : FIRSTα)
                        if (FOLLOW[A].count(x)) return false;
            }
        }
    }
    return true;
}
