#include <bits/stdc++.h>
using namespace std;

map<char, vector<string>> prod;

bool derive(string curr, string target) {
    if (curr == target) return true;
    if (curr.size() > target.size()) return false;

    for (int i = 0; i < curr.size(); i++) {
        if (isupper(curr[i])) {
            char NT = curr[i];
            for (auto &rhs : prod[NT]) {
                string nxt = curr.substr(0, i) + rhs + curr.substr(i + 1);
                if (derive(nxt, target)) return true;
            }
            return false;
        }
    }
    return false;
}

int main() {
    int n; cin >> n;
    string p, target;
    getline(cin, p);

    for (int i = 0; i < n; i++) {
        getline(cin, p);
        char A = p[0];
        int pos = p.find("->");
        string rhs = p.substr(pos + 2);
        prod[A].push_back(rhs);
    }

    cout << "Enter target string: ";
    cin >> target;

    if (derive("S", target))
        cout << "Parse tree / derivation is VALID.\n";
    else
        cout << "INVALID derivation according to grammar.\n";
}
